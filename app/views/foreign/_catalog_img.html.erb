<script type="text/javascript">
  $(document).ready(function()
  {
    $('.all-list').toggle(function(){
      $(this).prev().html('-');
    }, function(){
      $(this).prev().html('+');
    });    

    $('.all-list').bind('click', function(){
      $(this).prev().prev().parent().find('li.g-hidden').toggle();        
      return false;     
    });
  })
</script>


<ul class="ul_v">
<% Category.cached_active_categories.select{|c| c.kind==0 }.each do |cat| -%>
<li class="li_v">

    <ul class="text_c_ul">
    <% Category.cached_active_categories.select{|c| c.virtual_id == cat.id}.each_with_index do |child_cat, index| -%>
      <% if index > 4  -%>
        <%= content_tag(:li,link_to(child_cat.name, category_path(child_cat)+ '.html', :class=>"text_n_z", :title => child_cat.name), :class => "g-hidden") %>              
      <% else -%>
        <%= content_tag(:li,link_to(child_cat.name, category_path(child_cat)+ '.html', :class=>"text_n_z", :title => child_cat.name)) %>
      <% end -%>
    <% end -%>
<%= content_tag(:span, "+", :class => "text_n_z") + link_to( "весь список", "#", :class=>"all-list") if Category.cached_active_categories.select{|c| c.virtual_id == cat.id}.size >5 %>
</ul>
</li>
<% end -%>
</ul>
<div class="clear"></div>

